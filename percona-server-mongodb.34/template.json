{
    "variables":{
        "vm_name": "percona-mongodb-34",
        "cpu": "2",
        "ram_size": "1024",
        "iso_url":"http://cdimage.debian.org/cdimage/archive/8.8.0/amd64/iso-cd/debian-8.8.0-amd64-CD-1.iso",
        "iso_checksum_type":"sha256",
        "iso_checksum":"673079527fdf3a91e8bfc9e0312f94316820ca795bb6a1b2af1e8461eb78179c",
        "disk_size": "21440",
        "ssh_username":"packer",
        "ssh_password":"packer"
    },
    "builders":[
        {
        "type": "docker",
        "image": "debian:jessie",
        "commit": "true",
        "changes":[
            "VOLUME [\"/data/db\"]",
            "ENTRYPOINT [\"/entrypoint.sh\"]",
            "EXPOSE 27017",
            "USER mongodb",
            "CMD [\"mongod\"]"
        ]
    },
    {
        "type":"vmware-iso",
        "boot_command":[
            "<esc><wait>",
            "install <wait>",
            " preseed/url=http://{{ .HTTPIP }}:{{ .HTTPPort }}/preseed.cfg <wait>",
            "debian-installer=en_US.UTF-8 <wait>",
            "auto <wait>",
            "locale=en_US.UTF-8 <wait>",
            "kbd-chooser/method=us <wait>",
            "keyboard-configuration/xkb-keymap=us <wait>",
            "netcfg/get_hostname={{ .Name }} <wait>",
            "netcfg/get_domain=vagrantup.com <wait>",
            "fb=false <wait>",
            "debconf/frontend=noninteractive <wait>",
            "console-setup/ask_detect=false <wait>",
            "console-keymaps-at/keymap=us <wait>",
            "grub-installer/bootdev=/dev/sda <wait>",
            "<enter><wait>"
        ],
        "boot_wait":"15s",
        "disk_size":"{{user `disk_size`}}",
        "guest_os_type":"debian8-64",
        "headless": true,
        "http_directory":"http",
        "iso_urls":"{{user `iso_url`}}",
        "iso_checksum_type":"{{user `iso_checksum_type`}}", 
        "iso_checksum":"{{user `iso_checksum`}}", 
        "ssh_username":"{{user `ssh_username`}}", 
        "ssh_password":"{{user `ssh_password`}}", 
        "ssh_wait_timeout": "10000s",
        "tools_upload_flavor":"linux",
        "shutdown_command":"echo 'packer'|sudo -S shutdown -P now", 
        "vm_name":"packer-debian-8-amd64",
        "vmx_data":{
            "cpuid.coresPerSocket":"1",
            "ethernet0.pciSlotNumber": "32",
            "memsize":"1024",
            "numvcpus":"1"
        }
    }
],
    "provisioners": [
        {
            "type":"shell",
            "script": "scripts/ansible.sh"
        },
        {
            "type":"file",
            "source": "scripts/ps-entry.sh",
            "destination": "/entrypoint.sh"
        },
        {
            "type":"ansible-local",
            "playbook_file":"ansible/main.yml",
            "playbook_dir":"ansible"
        },
        {
            "type":"shell",
            "script": "scripts/cleanup.sh"
        }

        ],
    "post-processors": [
        [
            {
                "type": "docker-tag",
                "repository": "tmosleytc/packerdemo",
                "tag": "0.1"
            }
        ]
    ]
}